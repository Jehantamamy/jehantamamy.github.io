!function(){let e=window.location.hostname;if("localhost"===e||"127.0.0.1"===e||""===e){"file:"===window.location.protocol&&t();return}function t(){throw document.body.innerHTML=`
				<div style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; background:#0f172a; color:white; font-family:sans-serif; text-align:center;">
					<h1 style="font-size:3rem; color:#ef4444;">⛔ AKSES DITOLAK</h1>
					<p style="font-size:1.2rem; margin-top:1rem;">Aplikasi ini dilindungi Hak Cipta dan hanya dapat digunakan melalui website resmi.</p>
					<a href="https://ariestechlab.com" style="margin-top:2rem; padding:10px 20px; background:#10b981; color:white; text-decoration:none; border-radius:8px; font-weight:bold;">Buka Aries Tech Labs</a>
				</div>
			`,Error("Illegal execution environment detected.")}["ariestechlab.com","www.ariestechlab.com"].includes(e)||t()}();let filesArray=[],currentMode="merge";const dropZone=document.getElementById("drop-zone"),fileInput=document.getElementById("file-input"),fileListEl=document.getElementById("file-list"),fileListContainer=document.getElementById("file-list-container"),emptyState=document.getElementById("empty-state"),loading=document.getElementById("loading"),fileCount=document.getElementById("file-count"),uploadText=document.getElementById("upload-text"),uploadIcon=document.getElementById("upload-icon"),actionBtn=document.getElementById("action-btn");function setMode(e){currentMode=e,filesArray=[],renderList(),["merge","img2pdf","optimize"].forEach(t=>{let i=document.getElementById(`tab-${t}`);t===e?i.className="tab-btn tab-active flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 rounded-t-lg transition-all":i.className="tab-btn tab-inactive flex-1 py-3 text-sm font-bold flex items-center justify-center gap-2 rounded-t-lg transition-all hover:bg-slate-800/50"});let t=document.getElementById("mode-desc");"merge"===e?(t.innerText="Combine multiple PDF files into one single document.",fileInput.setAttribute("accept","application/pdf"),uploadText.innerText="Click to Add PDFs",uploadIcon.innerText="\uD83D\uDCD1",actionBtn.innerHTML="<span>⚡</span> MERGE PDFs NOW"):"img2pdf"===e?(t.innerText="Convert JPG/PNG images into a single PDF file.",fileInput.setAttribute("accept","image/jpeg, image/png"),uploadText.innerText="Click to Add Images",uploadIcon.innerText="\uD83D\uDDBC️",actionBtn.innerHTML="<span>⚡</span> CONVERT TO PDF"):"optimize"===e&&(t.innerText="Clean & Re-save PDF to reduce size (Metadata cleanup).",fileInput.setAttribute("accept","application/pdf"),uploadText.innerText="Add PDF to Optimize",uploadIcon.innerText="\uD83D\uDE80",actionBtn.innerHTML="<span>⚡</span> OPTIMIZE PDF")}function handleFiles(e){let t="img2pdf"===currentMode?["image/jpeg","image/png"]:["application/pdf"],i=Array.from(e).filter(e=>t.includes(e.type));if(0===i.length&&e.length>0){alert(`Invalid file type! Please upload ${"img2pdf"===currentMode?"Images (JPG/PNG)":"PDF"} only.`);return}"optimize"===currentMode&&(filesArray=[],i.length>1&&alert("Optimization mode only accepts 1 file at a time. Using the first one."),i.splice(1)),i.forEach(e=>{filesArray.push({id:Date.now()+Math.random().toString(36).substr(2,9),file:e})}),renderList()}function renderList(){fileListEl.innerHTML="",filesArray.length>0?(emptyState.classList.add("hidden"),fileListContainer.classList.remove("hidden")):(emptyState.classList.remove("hidden"),fileListContainer.classList.add("hidden")),fileCount.innerText=filesArray.length,filesArray.forEach((e,t)=>{let i="img2pdf"===currentMode?"\uD83D\uDDBC️":"\uD83D\uDCC4",n=document.createElement("li");n.className="bg-slate-800/80 p-2.5 rounded-lg flex items-center justify-between group cursor-move border border-transparent hover:border-rose-500/30 transition-all select-none",n.setAttribute("data-id",e.id),n.innerHTML=`
                <div class="flex items-center gap-3 overflow-hidden">
                    <div class="text-slate-600 cursor-move px-1 hover:text-white">⋮⋮</div>
                    <div class="w-8 h-8 rounded bg-slate-700 flex items-center justify-center text-xs">${i}</div>
                    <div class="flex-col overflow-hidden">
                        <p class="text-xs text-white truncate font-medium w-32 md:w-64">${e.file.name}</p>
                        <p class="text-[9px] text-slate-500 font-mono">${formatBytes(e.file.size)}</p>
                    </div>
                </div>
                <div class="flex items-center gap-1">
                    <button onclick="previewFile('${e.id}')" class="text-sky-500 hover:text-white p-1.5 rounded hover:bg-sky-600 transition" title="Preview">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>
                    </button>
                    <button onclick="removeFile('${e.id}')" class="text-slate-500 hover:text-white p-1.5 rounded hover:bg-rose-600 transition" title="Remove">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                </div>
            `,fileListEl.appendChild(n)})}function removeFile(e){filesArray=filesArray.filter(t=>t.id!==e),renderList(),fileInput.value=""}function clearAll(){confirm("Clear all files?")&&(filesArray=[],renderList(),fileInput.value="")}function previewFile(e){let t=filesArray.find(t=>t.id===e);if(t){let i=URL.createObjectURL(t.file);window.open(i,"_blank")}}function processAction(){"merge"===currentMode?mergePDFs():"img2pdf"===currentMode?imagesToPDF():"optimize"===currentMode&&optimizePDF()}async function mergePDFs(){if(filesArray.length<2){alert("Please upload at least 2 PDF files.");return}loading.classList.remove("hidden");try{let{PDFDocument:e}=PDFLib,t=await e.create();for(let i of filesArray){let n=await i.file.arrayBuffer(),a=await e.load(n),r=await t.copyPages(a,a.getPageIndices());r.forEach(e=>t.addPage(e))}let l=await t.save();download(l,`Merged_Forge_${Date.now()}.pdf`,"application/pdf")}catch(o){console.error(o),alert("Error: One of the files might be corrupted.")}finally{loading.classList.add("hidden")}}async function imagesToPDF(){if(!(filesArray.length<1)){loading.classList.remove("hidden");try{let{PDFDocument:e}=PDFLib,t=await e.create();for(let i of filesArray){let n=await i.file.arrayBuffer(),a;a="image/jpeg"===i.file.type?await t.embedJpg(n):await t.embedPng(n);let r=t.addPage([a.width,a.height]);r.drawImage(a,{x:0,y:0,width:a.width,height:a.height})}let l=await t.save();download(l,`Images_Converted_${Date.now()}.pdf`,"application/pdf")}catch(o){console.error(o),alert("Error converting images. Ensure they are valid JPG/PNG.")}finally{loading.classList.add("hidden")}}}async function optimizePDF(){if(!(filesArray.length<1)){loading.classList.remove("hidden");try{let{PDFDocument:e}=PDFLib,t=await filesArray[0].file.arrayBuffer(),i=await e.load(t),n=await i.save();download(n,`Optimized_${filesArray[0].file.name}`,"application/pdf")}catch(a){console.error(a),alert("Optimization failed. File might be encrypted.")}finally{loading.classList.add("hidden")}}}function formatBytes(e){if(!+e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,t)).toFixed(1))} ${["B","KB","MB","GB"][t]}`}["dragenter","dragover","dragleave","drop"].forEach(e=>{dropZone.addEventListener(e,e=>{e.preventDefault(),e.stopPropagation()},!1)}),dropZone.addEventListener("dragover",()=>dropZone.classList.add("drag-active")),dropZone.addEventListener("dragleave",()=>dropZone.classList.remove("drag-active")),dropZone.addEventListener("drop",e=>{dropZone.classList.remove("drag-active"),handleFiles(e.dataTransfer.files)}),fileInput.addEventListener("change",function(){handleFiles(this.files)}),new Sortable(fileListEl,{animation:150,ghostClass:"bg-slate-700",onEnd:function(e){let t=[];fileListEl.querySelectorAll("li").forEach(e=>{let i=e.getAttribute("data-id"),n=filesArray.find(e=>e.id===i);n&&t.push(n)}),filesArray=t}}),document.addEventListener("DOMContentLoaded",()=>{initSessionManager()});