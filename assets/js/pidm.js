!function(){let e=window.location.hostname;if("localhost"===e||"127.0.0.1"===e||""===e){"file:"===window.location.protocol&&t();return}function t(){throw document.body.innerHTML=`
					<div style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; background:#0f172a; color:white; font-family:sans-serif; text-align:center;">
						<h1 style="font-size:3rem; color:#ef4444;">â›” AKSES DITOLAK</h1>
						<p style="font-size:1.2rem; margin-top:1rem;">Aplikasi ini dilindungi Hak Cipta dan hanya dapat digunakan melalui website resmi.</p>
						<a href="https://ariestechlab.com" style="margin-top:2rem; padding:10px 20px; background:#10b981; color:white; text-decoration:none; border-radius:8px; font-weight:bold;">Buka Aries Tech Labs</a>
					</div>
				`,Error("Illegal execution environment detected.")}["ariestechlab.com","www.ariestechlab.com"].includes(e)||t()}();const CANVAS_W=1e3,CANVAS_H=400;let robotX=500,robotAngle=0,lineX=500,trackOffset=0,lastTime=performance.now(),lastError=0,integral=0,currentAngularVel=0,actualLeftSpeed=0,actualRightSpeed=0;const canvas=document.getElementById("simCanvas"),ctx=canvas.getContext("2d");canvas.width=1e3,canvas.height=400;const ctxChart=document.getElementById("chartCanvas").getContext("2d"),perfChart=new Chart(ctxChart,{type:"line",data:{labels:Array(150).fill(""),datasets:[{label:"Robot",data:Array(150).fill(50),borderColor:"#f43f5e",borderWidth:2,pointRadius:0,tension:.1},{label:"Target",data:Array(150).fill(50),borderColor:"#fbbf24",borderWidth:2,borderDash:[5,5],pointRadius:0,fill:!0,backgroundColor:"rgba(251, 191, 36, 0.05)"}]},options:{responsive:!0,maintainAspectRatio:!1,animation:!1,interaction:{mode:"none"},scales:{y:{min:0,max:100,grid:{color:"#1e293b"}},x:{display:!1}},plugins:{legend:{display:!0},tooltip:{enabled:!1}}}});function loop(){let e=performance.now(),t=(e-lastTime)/1e3;lastTime=e,t>.1&&(t=.1);let l=parseInt(document.getElementById("base-speed").value),a=parseFloat(document.getElementById("kp").value),n=parseFloat(document.getElementById("ki").value),i=parseFloat(document.getElementById("kd").value),o=parseInt(document.getElementById("inertia").value),r=parseInt(document.getElementById("friction").value),$=parseFloat(document.getElementById("line-pos").value),c=parseInt(document.getElementById("sensor-limit").value),d=document.getElementById("control-mode").value,s=document.getElementById("sensor-type").value;document.getElementById("val-base").innerText=l,document.getElementById("val-kp").innerText=a.toFixed(1),document.getElementById("val-ki").innerText=n.toFixed(3),document.getElementById("val-kd").innerText=i.toFixed(1),document.getElementById("val-inertia").innerText=o+"%",document.getElementById("val-friction").innerText=r+"%",document.getElementById("val-sensor").innerText=c+"px";let g=$/100*1e3,x=robotX+45*Math.sin(robotAngle),f=g-x;if("analog"!==s){let _=c/("digital-8"===s?8:16);f=Math.round(f/_)*_}let u=f,b=c/2,h=!1;u>b?(u=b,h=!0):u<-b&&(u=-b,h=!0),integral+=u*t;let m=(u-lastError)/t;integral>100&&(integral=100),integral<-100&&(integral=-100);let p=(a*u+n*integral+i*m)*.5;lastError=u;let y=l+p,v=l-p;y=Math.max(-255,Math.min(255,y)),v=Math.max(-255,Math.min(255,v));let B,E;"direct"===d?(actualLeftSpeed=y,actualRightSpeed=v):(actualLeftSpeed+=(y-actualLeftSpeed)*.2,actualRightSpeed+=(v-actualRightSpeed)*.2),B=actualLeftSpeed,E=actualRightSpeed;let A=(B-E)*.04;if(0===o)currentAngularVel=A;else{let I=.8-o/120;I<.01&&(I=.01),currentAngularVel+=(A-currentAngularVel)*I}currentAngularVel*=.995-r/500,(robotAngle+=currentAngularVel*t)>1.5&&(robotAngle=1.5),robotAngle<-1.5&&(robotAngle=-1.5);let S=(B+E)*.5;(trackOffset+=S*t*2)>80&&(trackOffset=0),(robotX+=Math.sin(robotAngle)*(Math.abs(S)+50)*t*3)<20&&(robotX=20,robotAngle=.1,currentAngularVel=0),robotX>980&&(robotX=980,robotAngle=-.1,currentAngularVel=0),drawScene(g,robotX,robotAngle,c),updateBars(B,E),document.getElementById("disp-error").innerText=u.toFixed(1),document.getElementById("disp-angle").innerText=(57.29*robotAngle).toFixed(1);let k=document.getElementById("sat-indicator");h?k.classList.remove("hidden"):k.classList.add("hidden"),updateChartData(g,x),requestAnimationFrame(loop)}function drawScene(e,t,l,a){ctx.fillStyle="#0f172a",ctx.fillRect(0,0,1e3,400),ctx.strokeStyle="#1e293b",ctx.lineWidth=1;for(let n=0;n<=1e3;n+=100)ctx.beginPath(),ctx.moveTo(n,0),ctx.lineTo(n,400),ctx.stroke();for(let i=trackOffset;i<400;i+=80)ctx.beginPath(),ctx.moveTo(0,i),ctx.lineTo(1e3,i),ctx.stroke();ctx.shadowColor="#fbbf24",ctx.shadowBlur=10,ctx.strokeStyle="#fbbf24",ctx.lineWidth=4,ctx.beginPath(),ctx.moveTo(e,0),ctx.lineTo(e,400),ctx.stroke(),ctx.shadowBlur=0,ctx.save(),ctx.translate(t,320),ctx.rotate(l),ctx.fillStyle="rgba(16, 185, 129, 0.15)",ctx.fillRect(-a/2,-45,a,15),ctx.strokeStyle="#34d399",ctx.lineWidth=1,ctx.setLineDash([2,2]),ctx.strokeRect(-a/2,-45,a,15),ctx.setLineDash([]),ctx.fillStyle="#334155",ctx.strokeStyle="#94a3b8",ctx.lineWidth=2,ctx.beginPath(),ctx.roundRect(-30,-40,60,80,10),ctx.fill(),ctx.stroke(),ctx.fillStyle="#38bdf8",ctx.fillRect(-38,-20,8,40),ctx.fillStyle="#f43f5e",ctx.fillRect(30,-20,8,40),ctx.fillStyle="#10b981",ctx.fillRect(-20,-38,40,4),ctx.beginPath(),ctx.moveTo(0,-30),ctx.lineTo(-8,-10),ctx.lineTo(8,-10),ctx.fillStyle="#fbbf24",ctx.fill(),ctx.restore()}function updateBars(e,t){document.getElementById("bar-left").style.height=`${(e+255)/510*100}%`,document.getElementById("bar-right").style.height=`${(t+255)/510*100}%`}let frameCount=0;function updateChartData(e,t){if(++frameCount%3!=0)return;let l=perfChart.data.datasets[0].data,a=perfChart.data.datasets[1].data;l.push(t/1e3*100),l.shift(),a.push(e/1e3*100),a.shift(),perfChart.update("none")}function setLine(e){document.getElementById("line-pos").value=e}loop();